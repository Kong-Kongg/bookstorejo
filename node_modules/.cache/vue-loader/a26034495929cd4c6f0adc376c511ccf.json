{"remainingRequest":"/Users/jingwow/Desktop/STUDY/前段框架开发/bookstorejo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jingwow/Desktop/STUDY/前段框架开发/bookstorejo/src/views/Books.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jingwow/Desktop/STUDY/前段框架开发/bookstorejo/src/views/Books.vue","mtime":1669789949688},{"path":"/Users/jingwow/Desktop/STUDY/前段框架开发/bookstorejo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jingwow/Desktop/STUDY/前段框架开发/bookstorejo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jingwow/Desktop/STUDY/前段框架开发/bookstorejo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jingwow/Desktop/STUDY/前段框架开发/bookstorejo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQm9va0xpc3QgZnJvbSAnQC9jb21wb25lbnRzL0Jvb2tMaXN0JzsNCmltcG9ydCBMb2FkaW5nIGZyb20gJ0AvY29tcG9uZW50cy9Mb2FkaW5nLnZ1ZSc7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdCb29rcycsDQogIHByb3BzOiBbJyddLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB0aXRsZTogJycsDQogICAgICBib29rczogW10sDQogICAgICBtZXNzYWdlOiAnJywNCiAgICAgIGxvYWRpbmc6IHRydWUsDQogICAgICB0b3RhbDogNSwNCiAgICAgIHBhZ2VOdW06IDEsDQogICAgICBwYWdlU2l6ZTogMiwNCiAgICB9Ow0KICB9LA0KDQogIGJlZm9yZVJvdXRlRW50ZXIodG8sIGZyb20sIG5leHQpIHsNCiAgICBuZXh0KCh2bSkgPT4gew0KICAgICAgdm0udGl0bGUgPSB0by5tZXRhLnRpdGxlOw0KICAgICAgbGV0IHVybCA9IHZtLnNldFJlcXVlc3RVcmwodG8uZnVsbFBhdGgpOw0KICAgICAgdm0uZ2V0Qm9va3ModXJsLCB2bS5wYWdlTnVtLCB2bS5wYWdlU2l6ZSk7DQogICAgfSk7DQogIH0sDQogIGJlZm9yZVJvdXRlVXBkYXRlKHRvLCBmcm9tLCBuZXh0KSB7DQogICAgbGV0IHVybCA9IHRoaXMuc2V0UmVxdWVzdFVybCh0by5mdWxsUGF0aCk7DQogICAgdGhpcy5nZXRCb29rcyh1cmwsIHRoaXMucGFnZU51bSwgdGhpcy5wYWdlU2l6ZSk7DQogICAgbmV4dCgpOw0KICB9LA0KDQogIGNvbXBvbmVudHM6IHsNCiAgICBCb29rTGlzdCwNCiAgICBMb2FkaW5nLA0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICBnZXRCb29rcyh1cmwsIHBhZ2VOdW0sIHBhZ2VTaXplKSB7DQogICAgICB0aGlzLm1lc3NhZ2UgPSAnJzsNCiAgICAgIHRoaXMuYXhpb3MNCiAgICAgICAgLmdldCh1cmwsIHsgcGFyYW1zOiB7IHBhZ2VOdW0sIHBhZ2VTaXplIH0gfSkNCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7DQoNCiAgICAgICAgICAvLyBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDIwMCkgew0KICAgICAgICAgIC8vICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAgICAgLy8gICB0aGlzLmJvb2tzID0gcmVzcG9uc2UuZGF0YS5kYXRhOw0KICAgICAgICAgIC8vICAgdGhpcy50b3RhbCA9IHJlc3BvbnNlLmRhdGEudG90YWw7DQogICAgICAgICAgLy8gICBpZiAodGhpcy5ib29rcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAvLyAgICAgaWYgKHRoaXMuJHJvdXRlLm5hbWUgPT09ICdjYXRlZ29yeScpDQogICAgICAgICAgLy8gICAgICAgdGhpcy5tZXNzYWdlID0gJ+W9k+WJjeWIhuexu+S4i+ayoeacieWbvuS5pu+8gSc7DQogICAgICAgICAgLy8gICAgIGVsc2UgdGhpcy5tZXNzYWdlID0gJ+ayoeacieaQnOe0ouWIsOWMuemFjeeahOWbvuS5pu+8gSc7DQogICAgICAgICAgLy8gICB9DQogICAgICAgICAgLy8gfQ0KDQogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAgICAgdGhpcy5ib29rcyA9IHJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgdGhpcy50b3RhbCA9IHJlc3BvbnNlLmRhdGEudG90YWw7DQogICAgICAgICAgaWYgKHRoaXMuYm9va3MubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICBpZiAodGhpcy4kcm91dGUubmFtZSA9PT0gJ2NhdGVnb3J5JykNCiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gJ+W9k+WJjeWIhuexu+S4i+ayoeacieWbvuS5pu+8gSc7DQogICAgICAgICAgICBlbHNlIHRoaXMubWVzc2FnZSA9ICfmsqHmnInmkJzntKLliLDljLnphY3nmoTlm77kuabvvIEnOw0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gYWxlcnQoZXJyb3IpKTsNCiAgICB9LA0KICAgIC8vIOWKqOaAgeiuvue9ruacjeWKoeerr+aVsOaNruaOpeWPo+eahOivt+axglVSTA0KICAgIHNldFJlcXVlc3RVcmwocGF0aCkgew0KICAgICAgbGV0IHVybCA9IHBhdGg7DQogICAgICAvLyBpZiAocGF0aC5pbmRleE9mKCcvY2F0ZWdvcnknKSAhPSAtMSkgew0KICAgICAgLy8gICB1cmwgPSAnL2Jvb2snICsgdXJsICsgJy9wYWdlJzsNCiAgICAgIC8vIH0NCiAgICAgIHJldHVybiB1cmw7DQogICAgfSwNCiAgICBoYW5kbGVTaXplQ2hhbmdlKHNlbGVjdGVkU2l6ZSkgew0KICAgICAgdGhpcy5wYWdlU2l6ZSA9IHNlbGVjdGVkU2l6ZTsNCiAgICAgIC8vY29uc29sZS5sb2codGhpcy5wYWdlU2l6ZSkgLy/mr4/pobXkuIvmi4nmmL7npLrmlbDmja7mnaHmlbANCiAgICAgIGxldCB1cmwgPSB0aGlzLnNldFJlcXVlc3RVcmwodGhpcy4kcm91dGUuZnVsbFBhdGgpOw0KICAgICAgdGhpcy5nZXRCb29rcyh1cmwsIHRoaXMucGFnZU51bSwgdGhpcy5wYWdlU2l6ZSk7DQogICAgfSwNCg0KICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UoY3VycmVudFBhZ2UpIHsNCiAgICAgIHRoaXMucGFnZU51bSA9IGN1cnJlbnRQYWdlOw0KICAgICAgbGV0IHVybCA9IHRoaXMuc2V0UmVxdWVzdFVybCh0aGlzLiRyb3V0ZS5mdWxsUGF0aCk7DQogICAgICAvL2NvbnNvbGUubG9nKGN1cnJlbnRQYWdlKSAvL+eCueWHu+esrOWHoOmhtQ0KICAgICAgdGhpcy5nZXRCb29rcyh1cmwsIHRoaXMucGFnZU51bSwgdGhpcy5wYWdlU2l6ZSk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["Books.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Books.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <Loading v-if=\"loading\" />\r\n    <h3 v-else>{{ title }}</h3>\r\n    <BookList :list=\"books\" v-if=\"books.length\" />\r\n    <h1>{{ message }}</h1>\r\n\r\n    <el-pagination\r\n      :hide-on-single-page=\"true\"\r\n      @size-change=\"handleSizeChange\"\r\n      :page-sizes=\"[2, 10, 20, 40]\"\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page=\"pageNum\"\r\n      :page-size=\"pageSize\"\r\n      layout=\"total, sizes, prev, pager, next, jumper\"\r\n      :total=\"total\"\r\n    >\r\n    </el-pagination\r\n    ><br />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport BookList from '@/components/BookList';\r\nimport Loading from '@/components/Loading.vue';\r\nexport default {\r\n  name: 'Books',\r\n  props: [''],\r\n  data() {\r\n    return {\r\n      title: '',\r\n      books: [],\r\n      message: '',\r\n      loading: true,\r\n      total: 5,\r\n      pageNum: 1,\r\n      pageSize: 2,\r\n    };\r\n  },\r\n\r\n  beforeRouteEnter(to, from, next) {\r\n    next((vm) => {\r\n      vm.title = to.meta.title;\r\n      let url = vm.setRequestUrl(to.fullPath);\r\n      vm.getBooks(url, vm.pageNum, vm.pageSize);\r\n    });\r\n  },\r\n  beforeRouteUpdate(to, from, next) {\r\n    let url = this.setRequestUrl(to.fullPath);\r\n    this.getBooks(url, this.pageNum, this.pageSize);\r\n    next();\r\n  },\r\n\r\n  components: {\r\n    BookList,\r\n    Loading,\r\n  },\r\n\r\n  methods: {\r\n    getBooks(url, pageNum, pageSize) {\r\n      this.message = '';\r\n      this.axios\r\n        .get(url, { params: { pageNum, pageSize } })\r\n        .then((response) => {\r\n          console.log(response.data);\r\n\r\n          // if (response.data.code == 200) {\r\n          //   this.loading = false;\r\n          //   this.books = response.data.data;\r\n          //   this.total = response.data.total;\r\n          //   if (this.books.length === 0) {\r\n          //     if (this.$route.name === 'category')\r\n          //       this.message = '当前分类下没有图书！';\r\n          //     else this.message = '没有搜索到匹配的图书！';\r\n          //   }\r\n          // }\r\n\r\n          this.loading = false;\r\n          this.books = response.data;\r\n          this.total = response.data.total;\r\n          if (this.books.length === 0) {\r\n            if (this.$route.name === 'category')\r\n              this.message = '当前分类下没有图书！';\r\n            else this.message = '没有搜索到匹配的图书！';\r\n          }\r\n        })\r\n        .catch((error) => alert(error));\r\n    },\r\n    // 动态设置服务端数据接口的请求URL\r\n    setRequestUrl(path) {\r\n      let url = path;\r\n      // if (path.indexOf('/category') != -1) {\r\n      //   url = '/book' + url + '/page';\r\n      // }\r\n      return url;\r\n    },\r\n    handleSizeChange(selectedSize) {\r\n      this.pageSize = selectedSize;\r\n      //console.log(this.pageSize) //每页下拉显示数据条数\r\n      let url = this.setRequestUrl(this.$route.fullPath);\r\n      this.getBooks(url, this.pageNum, this.pageSize);\r\n    },\r\n\r\n    handleCurrentChange(currentPage) {\r\n      this.pageNum = currentPage;\r\n      let url = this.setRequestUrl(this.$route.fullPath);\r\n      //console.log(currentPage) //点击第几页\r\n      this.getBooks(url, this.pageNum, this.pageSize);\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped></style>\r\n"]}]}